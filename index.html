<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Diagnóstico</title>
<style>
body{background:#0a0b0f;color:#e8eaf0;font-family:sans-serif;padding:20px}
.ok{color:#2dd4a0}.err{color:#f7645a}.box{background:#11131a;border:1px solid #333;border-radius:8px;padding:12px;margin-bottom:8px;font-size:14px}
</style>
</head>
<body>
<h2>Diagnóstico HoldingCRM</h2>
<div id="out"></div>
<script>
var out = document.getElementById('out');
function log(msg, ok) {
  var d = document.createElement('div');
  d.className = 'box ' + (ok===false?'err':'ok');
  d.textContent = (ok===false?'❌ ':'✅ ') + msg;
  out.appendChild(d);
}
try { log('JavaScript básico OK'); } catch(e) { log('JS básico: '+e, false); }
try { var x = localStorage.getItem('test'); log('localStorage OK'); } catch(e) { log('localStorage: '+e, false); }
try { var d = new Date(); log('Date OK: '+d.toISOString()); } catch(e) { log('Date: '+e, false); }
try { var a = [1,2,3].filter(x=>x>1); log('Arrow functions OK'); } catch(e) { log('Arrow functions: '+e, false); }
try { var t = `template ${1+1}`; log('Template literals OK'); } catch(e) { log('Template literals: '+e, false); }
try { var o = {a:1}; var {a} = o; log('Destructuring OK'); } catch(e) { log('Destructuring: '+e, false); }
try { var p = new Promise(r=>r(1)); log('Promise OK'); } catch(e) { log('Promise: '+e, false); }
try { document.getElementById('out'); log('DOM querySelector OK'); } catch(e) { log('DOM: '+e, false); }
try {
  var DB = null;
  var loaded = localStorage.getItem('hcrm2');
  if (loaded) { DB = JSON.parse(loaded); log('DB carregado do localStorage: '+DB.companies.length+' empresas'); }
  else { log('localStorage vazio - vai criar DB demo'); }
} catch(e) { log('DB parse: '+e, false); }
try {
  function dAgo(n){var d=new Date();d.setDate(d.getDate()-n);return d.toISOString().split('T')[0];}
  var t = dAgo(5);
  log('Data calculada OK: '+t);
} catch(e) { log('Data calc: '+e, false); }
log('--- Diagnóstico completo ---');
</script>
</body>
</html>
